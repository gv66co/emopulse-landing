<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <title>EMOPULSE PRO - ULTIMATE CORE</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

    <style>
        body, html { margin: 0; padding: 0; background: #000105; overflow: hidden; }
        
        /* Tikrasis gylis per Overlay */
        #interface-layer {
            position: absolute;
            inset: 0;
            z-index: 100;
            pointer-events: none;
            display: flex;
            justify-content: space-between;
            padding: 50px;
            box-sizing: border-box;
            background: radial-gradient(circle at center, transparent 30%, rgba(0,2,10,0.8) 100%);
        }

        .panel {
            pointer-events: auto;
            background: rgba(2, 8, 20, 0.4);
            backdrop-filter: blur(30px);
            border: 1px solid rgba(58, 141, 255, 0.1);
            border-radius: 40px;
            padding: 35px;
            box-shadow: inset 0 0 20px rgba(58, 141, 255, 0.05);
        }

        .camera-ring {
            width: 240px; height: 240px;
            border-radius: 50%;
            border: 1px solid rgba(58, 141, 255, 0.4);
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(58, 141, 255, 0.2);
        }

        #webcam { width: 100%; height: 100%; object-fit: cover; filter: contrast(1.2) brightness(0.8); }

        .scan-line {
            position: absolute;
            width: 100%; height: 2px;
            background: linear-gradient(90deg, transparent, #3a8dff, transparent);
            box-shadow: 0 0 15px #3a8dff;
            top: 0; animation: scan 4s infinite linear;
        }

        @keyframes scan { 0% { top: -10%; } 100% { top: 110%; } }

        .value-neon {
            font-size: 48px; font-weight: 200;
            background: linear-gradient(180deg, #fff, #3a8dff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(58, 141, 255, 0.4);
        }
    </style>
</head>
<body>

    <div id="three-container"></div>

    <div id="interface-layer">
        <div style="display: flex; flex-direction: column; gap: 30px;">
            <div style="color: #3a8dff; letter-spacing: 8px; font-size: 11px; font-weight: 900;">SYSTEM_ACTIVE // V3.NAV</div>
            <div class="panel">
                <div style="opacity: 0.5; font-size: 10px; color: #fff; margin-bottom: 10px;">NEURAL RESONANCE</div>
                <div class="value-neon">76.4</div>
                <div style="color: #3a8dff; font-size: 12px; margin-top: 5px;">STABILITY: OPTIMAL</div>
            </div>
        </div>

        <div class="panel">
            <div class="camera-ring">
                <div class="scan-line"></div>
                <video id="webcam" autoplay muted playsinline></video>
            </div>
            <div style="margin-top: 30px;">
                <div style="color: #fff; font-size: 24px; font-weight: 700;">Calm Focused</div>
                <div style="color: #ff9f1c; font-size: 13px; margin-top: 5px; opacity: 0.8;">#deep_resonance #tranquility</div>
            </div>
        </div>
    </div>

    <script>
        let scene, camera, renderer, composer, core, particles;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 12;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('three-container').appendChild(renderer.domElement);

            // 1. BRANDUOLYS - TŪRINĖ SFERA
            const coreGroup = new THREE.Group();
            scene.add(coreGroup);

            // Pagrindinė šviečianti šerdis
            const coreGeo = new THREE.IcosahedronGeometry(1.8, 15);
            const coreMat = new THREE.MeshPhongMaterial({
                color: 0x3a8dff,
                emissive: 0x1a2a4a,
                wireframe: true,
                transparent: true,
                opacity: 0.3
            });
            core = new THREE.Mesh(coreGeo, coreMat);
            coreGroup.add(core);

            // 2. ORBITOS - NEONINIAI ŽIEDAI
            const ringColors = [0x3a8dff, 0x7b5cff, 0x00f2ff];
            for(let i=0; i<3; i++) {
                const ringGeo = new THREE.TorusGeometry(3 + i*0.6, 0.015, 16, 100);
                const ringMat = new THREE.MeshBasicMaterial({ 
                    color: ringColors[i], 
                    transparent: true, 
                    opacity: 0.6 
                });
                const ring = new THREE.Mesh(ringGeo, ringMat);
                ring.rotation.x = Math.random() * Math.PI;
                ring.rotation.y = Math.random() * Math.PI;
                coreGroup.add(ring);
            }

            // 3. DALELIŲ DEBESIS (AURA)
            const pGeo = new THREE.BufferGeometry();
            const pCount = 4000;
            const posArray = new Float32Array(pCount * 3);
            for(let i=0; i<pCount*3; i++) {
                posArray[i] = (Math.random() - 0.5) * 18;
            }
            pGeo.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            const pMat = new THREE.PointsMaterial({
                size: 0.03,
                color: 0x3a8dff,
                transparent: true,
                opacity: 0.4,
                blending: THREE.AdditiveBlending
            });
            particles = new THREE.Points(pGeo, pMat);
            scene.add(particles);

            // 4. POST-PROCESSING (TIKRAJAM GLOW)
            const renderScene = new THREE.RenderPass(scene, camera);
            const bloomPass = new THREE.UnrealBloomPass(
                new THREE.Vector2(window.innerWidth, window.innerHeight),
                2.5, // Stiprumas
                0.5, // Spindulys
                0.1  // Slenkstis
            );

            composer = new THREE.EffectComposer(renderer);
            composer.addPass(renderScene);
            composer.addPass(bloomPass);

            // Šviesa gyliui
            const light = new THREE.PointLight(0x3a8dff, 2, 50);
            light.position.set(5, 5, 5);
            scene.add(light);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.001;

            // DRIFT LOGIKA: Viskas juda kaip viena visuma
            core.rotation.y += 0.002;
            core.position.y = Math.sin(time * 0.5) * 0.4;
            core.position.x = Math.cos(time * 0.3) * 0.2;

            // Dalelių "kvėpavimas"
            particles.rotation.y -= 0.0005;
            particles.position.y = Math.sin(time * 0.2) * 0.1;

            composer.render();
        }

        navigator.mediaDevices.getUserMedia({ video: true }).then(s => {
            document.getElementById('webcam').srcObject = s;
        });

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>
