<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <title>EMOPULSE - SOLID STATE V3</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/EffectComposer.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/RenderPass.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/postprocessing/UnrealBloomPass.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@100;400;700&display=swap');

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%;
            background: #020408; font-family: 'Outfit', sans-serif;
            overflow: hidden; color: white;
        }

        /* Pagrindinis konteineris */
        #app-container {
            position: relative;
            width: 100vw; height: 100vh;
            display: grid;
            grid-template-columns: 1fr 400px;
            padding: 60px;
            box-sizing: border-box;
            z-index: 10;
        }

        /* 3D fonas */
        #canvas-bg {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
        }

        .left-header {
            display: flex;
            flex-direction: column;
            gap: 5px;
            opacity: 0.6;
        }

        .brand-title { font-weight: 100; letter-spacing: 12px; font-size: 14px; }
        .version-title { font-weight: 700; letter-spacing: 4px; font-size: 22px; }

        /* Solidus dešinės pusės skydelis */
        .side-panel {
            background: rgba(8, 12, 20, 0.6);
            backdrop-filter: blur(40px);
            border-left: 1px solid rgba(255, 255, 255, 0.05);
            padding: 40px;
            display: flex;
            flex-direction: column;
            box-shadow: -50px 0 100px rgba(0,0,0,0.8);
            pointer-events: auto;
        }

        .video-box {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            background: #000;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
        }

        #webcam { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; filter: contrast(1.1); }

        .live-dot {
            position: absolute; top: 15px; left: 15px;
            display: flex; align-items: center; gap: 8px;
            font-size: 9px; letter-spacing: 2px; color: #ff3b3b;
        }

        .dot { width: 6px; height: 6px; background: #ff3b3b; border-radius: 50%; box-shadow: 0 0 10px #ff3b3b; }

        .status-container { margin-top: 40px; }
        .label { font-size: 10px; color: #555; letter-spacing: 3px; margin-bottom: 10px; }
        .value { font-size: 42px; font-weight: 100; margin-bottom: 25px; }

        .drift-btn {
            border: 1px solid #3a8dff;
            color: #3a8dff;
            background: transparent;
            padding: 8px 20px;
            border-radius: 30px;
            font-size: 10px;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <div id="canvas-bg"></div>

    <div id="app-container">
        <div class="left-header">
            <div class="brand-title">NEURAL NAVIGATOR</div>
            <div class="version-title">SOLID STATE V3</div>
        </div>

        <div class="side-panel">
            <div class="video-box">
                <div class="live-dot"><div class="dot"></div> LIVE FEED</div>
                <video id="webcam" autoplay muted playsinline></video>
            </div>

            <div class="status-container">
                <div class="label">RESONANCE STATE</div>
                <div class="value">Deep Calm</div>
                <button class="drift-btn">Stable Drift</button>
            </div>
        </div>
    </div>

    <script>
        let scene, camera, renderer, composer, compass;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 12;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            document.getElementById('canvas-bg').appendChild(renderer.domElement);

            // PAGRINDINIS KOMPASAS (SOLID MECHANICS)
            compass = new THREE.Group();
            scene.add(compass);

            // Centrinė ašis
            const coreGeo = new THREE.IcosahedronGeometry(1.8, 1);
            const coreMat = new THREE.MeshPhysicalMaterial({ 
                color: 0x111111,
                metalness: 1,
                roughness: 0.1,
                envMapIntensity: 1,
                transparent: true,
                opacity: 0.8
            });
            const core = new THREE.Mesh(coreGeo, coreMat);
            compass.add(core);

            // Metaliniai žiedai (Gylis)
            const ringColors = [0x3a8dff, 0x1a1a1a, 0x555555];
            for(let i=0; i<3; i++) {
                const ringGeo = new THREE.TorusGeometry(3 + i*0.6, 0.02, 16, 100);
                const ringMat = new THREE.MeshStandardMaterial({ 
                    color: ringColors[i],
                    metalness: 1,
                    roughness: 0.3
                });
                const ring = new THREE.Mesh(ringGeo, ringMat);
                ring.rotation.x = Math.random() * Math.PI;
                ring.rotation.y = Math.random() * Math.PI;
                compass.add(ring);
            }

            // Šviesos gyliui
            const pLight = new THREE.PointLight(0x3a8dff, 4, 30);
            pLight.position.set(5, 5, 5);
            scene.add(pLight);

            const aLight = new THREE.AmbientLight(0xffffff, 0.2);
            scene.add(aLight);

            // BLOOM EFEKTAS (Tikrasis wow)
            const renderScene = new THREE.RenderPass(scene, camera);
            const bloomPass = new THREE.UnrealBloomPass(new THREE.Vector2(window.innerWidth, window.innerHeight), 1.5, 0.4, 0.85);
            composer = new THREE.EffectComposer(renderer);
            composer.addPass(renderScene);
            composer.addPass(bloomPass);

            animate();
        }

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.0006;

            // EMOTIONAL DRIFT logiką įkeliame čia
            compass.rotation.y += 0.002;
            compass.position.y = Math.sin(time) * 0.4; // Lėtas "plaukiojimas"
            compass.position.x = Math.cos(time * 0.7) * 0.2;

            composer.render();
        }

        // Paleisti kamerą
        navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
            document.getElementById('webcam').srcObject = stream;
        }).catch(e => console.log("Kameros klaida:", e));

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            composer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>
